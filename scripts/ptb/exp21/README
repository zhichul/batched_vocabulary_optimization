from scratch, with length reg, copied from exp15